<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live View</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <img id="liveView" src="" alt="Live View" width="800">

    <form id="shootModeForm">
        <select id="shootMode" name="shoot_mode">
            <option value="still">Still</option>
            <option value="movie">Movie</option>
            <option value="audio">Audio</option>
            <option value="intervalstill">Interval Still</option>
            <option value="looprec">Loop Recording</option>
        </select>
        <button type="submit">Set Shoot Mode</button>
    </form>
    
    <script>
        function startLiveView() {
            var liveViewElement = document.getElementById('liveView');
            var source = new EventSource("/");

            source.addEventListener('message', function(event) {
                liveViewElement.src = "data:image/jpeg;base64," + event.data;
            });

            source.addEventListener('error', function(event) {
                console.error("Error occurred:", event);
                source.close();
            });
        }

        startLiveView();

        document.getElementById('shootModeForm').addEventListener('submit', function(event) {
            event.preventDefault();

            var selectedMode = document.getElementById('shootMode').value;
            fetch('/set_shoot_mode', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({shoot_mode: selectedMode})
            })
            .then(response => response.text())
            .then(data => alert(data))
            .catch(error => console.error('Error:', error));
        });
    </script>
</body>
</html>


<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live View</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <img id="liveView" src="" alt="Live View" width="800">
    
    <script>
        // JavaScript to update the live view
        function updateLiveView() {
            var liveViewElement = document.getElementById('liveView');
            var source = new EventSource("/stream");
            
            source.addEventListener('message', function(event) {
                liveViewElement.src = "data:image/jpeg;base64," + event.data;
            });

            source.addEventListener('error', function(event) {
                console.error("Error occurred:", event);
                source.close();
            });
        }

        updateLiveView();
    </script>
</body>
</html> -->

<!-- <!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Live View</title>
        <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    </head>
    <body>
        <iframe src="{{ liveview_url }}" width="800" alt="Live View"></iframe>
    </body>
</html> -->